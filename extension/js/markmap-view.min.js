/**
 * Minified by jsDelivr using Terser v5.37.0.
 * Original file: /npm/markmap-view@0.18.10/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{Hook as dt,getId as pt,debounce as gt,addClass as ut,walkTree as R,noop as X}from"markmap-common";import{loadCSS as ze,loadJS as we}from"markmap-common";import{scaleOrdinal as Y,schemeCategory10 as mt,linkHorizontal as ft,zoomTransform as w,select as xt,zoom as yt,min as G,max as V,zoomIdentity as kt,minIndex as vt}from"d3";const Z=typeof navigator<"u"&&navigator.userAgent.includes("Macintosh"),bt=Y(mt),q=(t=1,e=3,r=2)=>a=>t+e/r**a.state.depth,J={autoFit:!1,duration:500,embedGlobalCSS:!0,fitRatio:.95,maxInitialScale:2,scrollForPan:Z,initialExpandLevel:-1,zoom:!0,pan:!0,toggleRecursively:!1,color:t=>{var e;return bt(`${(null==(e=t.state)?void 0:e.path)||""}`)},lineWidth:q(),maxWidth:0,nodeMinHeight:16,paddingX:8,spacingHorizontal:80,spacingVertical:5};function ke(t){const e={},r={...t},{color:a,colorFreezeLevel:i,lineWidth:n}=r;if(1===(null==a?void 0:a.length)){const t=a[0];e.color=()=>t}else if(null!=a&&a.length){const t=Y(a);e.color=e=>t(`${e.state.path}`)}if(i){const t=e.color||J.color;e.color=e=>(e={...e,state:{...e.state,path:e.state.path.split(".").slice(0,i).join(".")}},t(e))}if(n){const t=Array.isArray(n)?n:[n,0,1];e.lineWidth=q(...t)}return["duration","fitRatio","initialExpandLevel","maxInitialScale","maxWidth","nodeMinHeight","paddingX","spacingHorizontal","spacingVertical"].forEach((t=>{const a=r[t];"number"==typeof a&&(e[t]=a)})),["zoom","pan"].forEach((t=>{const a=r[t];null!=a&&(e[t]=!!a)})),e}function Et(t){let e=0;for(let r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r)|0;return(e>>>0).toString(36)}function v(t){if("string"==typeof t){const e=t;t=t=>t.matches(e)}const e=t;return function(){let t=Array.from(this.childNodes);return e&&(t=t.filter((t=>e(t)))),t}}function zt(t){var e=0,r=t.children,a=r&&r.length;if(a)for(;--a>=0;)e+=r[a].value;else e=1;t.value=e}function wt(){return this.eachAfter(zt)}function Ct(t){var e,r,a,i,n=this,s=[n];do{for(e=s.reverse(),s=[];n=e.pop();)if(t(n),r=n.children)for(a=0,i=r.length;a<i;++a)s.push(r[a])}while(s.length);return this}function St(t){for(var e,r,a=this,i=[a];a=i.pop();)if(t(a),e=a.children)for(r=e.length-1;r>=0;--r)i.push(e[r]);return this}function Rt(t){for(var e,r,a,i=this,n=[i],s=[];i=n.pop();)if(s.push(i),e=i.children)for(r=0,a=e.length;r<a;++r)n.push(e[r]);for(;i=s.pop();)t(i);return this}function Xt(t){return this.eachAfter((function(e){for(var r=+t(e.data)||0,a=e.children,i=a&&a.length;--i>=0;)r+=a[i].value;e.value=r}))}function jt(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))}function _t(t){for(var e=this,r=Ot(e,t),a=[e];e!==r;)e=e.parent,a.push(e);for(var i=a.length;t!==r;)a.splice(i,0,t),t=t.parent;return a}function Ot(t,e){if(t===e)return t;var r=t.ancestors(),a=e.ancestors(),i=null;for(t=r.pop(),e=a.pop();t===e;)i=t,t=r.pop(),e=a.pop();return i}function Mt(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function At(){var t=[];return this.each((function(e){t.push(e)})),t}function Tt(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t}function Ht(){var t=this,e=[];return t.each((function(r){r!==t&&e.push({source:r.parent,target:r})})),e}function H(t,e){var r,a,i,n,s,o=new j(t),l=+t.value&&(o.value=t.value),h=[o];for(null==e&&(e=Ft);r=h.pop();)if(l&&(r.value=+r.data.value),(i=e(r.data))&&(s=i.length))for(r.children=new Array(s),n=s-1;n>=0;--n)h.push(a=r.children[n]=new j(i[n])),a.parent=r,a.depth=r.depth+1;return o.eachBefore(Dt)}function Bt(){return H(this).eachBefore(Lt)}function Ft(t){return t.children}function Lt(t){t.data=t.data.data}function Dt(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function j(t){this.data=t,this.depth=this.height=0,this.parent=null}j.prototype=H.prototype={constructor:j,count:wt,each:Ct,eachAfter:Rt,eachBefore:St,sum:Xt,sort:jt,path:_t,ancestors:Mt,descendants:At,leaves:Tt,links:Ht,copy:Bt};const $t="d3-flextree",Nt="2.1.2",Wt="build/d3-flextree.js",It="index",Pt={name:"Chris Maloney",url:"http://chrismaloney.org"},Kt="Flexible tree layout algorithm that allows for variable node sizes.",Gt=["d3","d3-module","layout","tree","hierarchy","d3-hierarchy","plugin","d3-plugin","infovis","visualization","2d"],Vt="https://github.com/klortho/d3-flextree",Ut="WTFPL",Yt={type:"git",url:"https://github.com/klortho/d3-flextree.git"},Zt={clean:"rm -rf build demo test","build:demo":"rollup -c --environment BUILD:demo","build:dev":"rollup -c --environment BUILD:dev","build:prod":"rollup -c --environment BUILD:prod","build:test":"rollup -c --environment BUILD:test",build:"rollup -c",lint:"eslint index.js src","test:main":"node test/bundle.js","test:browser":"node test/browser-tests.js",test:"npm-run-all test:*",prepare:"npm-run-all clean build lint test"},qt={"d3-hierarchy":"^1.1.5"},Jt={"babel-plugin-external-helpers":"^6.22.0","babel-preset-es2015-rollup":"^3.0.0",d3:"^4.13.0","d3-selection-multi":"^1.0.1",eslint:"^4.19.1",jsdom:"^11.6.2","npm-run-all":"^4.1.2",rollup:"^0.55.3","rollup-plugin-babel":"^2.7.1","rollup-plugin-commonjs":"^8.0.2","rollup-plugin-copy":"^0.2.3","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.2","rollup-plugin-uglify":"^3.0.0","uglify-es":"^3.3.9"},Qt={name:$t,version:Nt,main:Wt,module:It,"jsnext:main":"index",author:Pt,description:Kt,keywords:Gt,homepage:Vt,license:Ut,repository:Yt,scripts:Zt,dependencies:qt,devDependencies:Jt},{version:te}=Qt,ee=Object.freeze({children:t=>t.children,nodeSize:t=>t.data.size,spacing:0});function tt(t){const e=Object.assign({},ee,t);function r(t){const r=e[t];return"function"==typeof r?r:()=>r}function a(t){const e=n(function(){const t=i(),e=r("nodeSize"),a=r("spacing");return class extends t{constructor(t){super(t),Object.assign(this,{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:this,lExtRelX:0,lThr:null,rExt:this,rExtRelX:0,rThr:null})}get size(){return e(this.data)}spacing(t){return a(this.data,t.data)}get x(){return this.data.x}set x(t){this.data.x=t}get y(){return this.data.y}set y(t){this.data.y=t}update(){return et(this),rt(this),this}}}(),t,(t=>t.children));return e.update(),e.data}function i(){const t=r("nodeSize"),e=r("spacing");return class r extends H.prototype.constructor{constructor(t){super(t)}copy(){const t=n(this.constructor,this,(t=>t.children));return t.each((t=>t.data=t.data.data)),t}get size(){return t(this)}spacing(t){return e(this,t)}get nodes(){return this.descendants()}get xSize(){return this.size[0]}get ySize(){return this.size[1]}get top(){return this.y}get bottom(){return this.y+this.ySize}get left(){return this.x-this.xSize/2}get right(){return this.x+this.xSize/2}get root(){const t=this.ancestors();return t[t.length-1]}get numChildren(){return this.hasChildren?this.children.length:0}get hasChildren(){return!this.noChildren}get noChildren(){return null===this.children}get firstChild(){return this.hasChildren?this.children[0]:null}get lastChild(){return this.hasChildren?this.children[this.numChildren-1]:null}get extents(){return(this.children||[]).reduce(((t,e)=>r.maxExtents(t,e.extents)),this.nodeExtents)}get nodeExtents(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}static maxExtents(t,e){return{top:Math.min(t.top,e.top),bottom:Math.max(t.bottom,e.bottom),left:Math.min(t.left,e.left),right:Math.max(t.right,e.right)}}}}function n(t,e,r){const a=(e,i)=>{const n=new t(e);Object.assign(n,{parent:i,depth:null===i?0:i.depth+1,height:0,length:1});const s=r(e)||[];return n.children=0===s.length?null:s.map((t=>a(t,n))),n.children&&Object.assign(n,n.children.reduce(((t,e)=>({height:Math.max(t.height,e.height+1),length:t.length+e.length})),n)),n};return a(e,null)}return Object.assign(a,{nodeSize(t){return arguments.length?(e.nodeSize=t,a):e.nodeSize},spacing(t){return arguments.length?(e.spacing=t,a):e.spacing},children(t){return arguments.length?(e.children=t,a):e.children},hierarchy(t,r){const a=typeof r>"u"?e.children:r;return n(i(),t,a)},dump(t){const e=r("nodeSize"),a=t=>r=>{const i=t+"  ",n=t+"    ",{x:s,y:o}=r,l=e(r),h=r.children||[],c=0===h.length?" ":`,${i}children: [${n}${h.map(a(n)).join(n)}${i}],${t}`;return`{ size: [${l.join(", ")}],${i}x: ${s}, y: ${o}${c}},`};return a("\n")(t)}}),a}tt.version=te;const et=(t,e=0)=>(t.y=e,(t.children||[]).reduce(((e,r)=>{const[a,i]=e;et(r,t.y+t.ySize);const n=(0===a?r.lExt:r.rExt).bottom;0!==a&&ne(t,a,i);return[a+1,de(n,a,i)]}),[0,null]),re(t),he(t),t),rt=(t,e,r)=>{typeof e>"u"&&(e=-t.relX-t.prelim,r=0);const a=e+t.relX;return t.relX=a+t.prelim-r,t.prelim=0,t.x=r+t.relX,(t.children||[]).forEach((e=>rt(e,a,t.x))),t},re=t=>{(t.children||[]).reduce(((t,e)=>{const[r,a]=t,i=r+e.shift,n=a+i+e.change;return e.relX+=n,[i,n]}),[0,0])},ne=(t,e,r)=>{const a=t.children[e-1],i=t.children[e];let n=a,s=a.relX,o=i,l=i.relX,h=!0;for(;n&&o;){n.bottom>r.lowY&&(r=r.next);const a=s+n.prelim-(l+o.prelim)+n.xSize/2+o.xSize/2+n.spacing(o);(a>0||a<0&&h)&&(l+=a,ie(i,a),se(t,e,r.index,a)),h=!1;const c=n.bottom,d=o.bottom;c<=d&&(n=ae(n),n&&(s+=n.relX)),c>=d&&(o=oe(o),o&&(l+=o.relX))}!n&&o?le(t,e,o,l):n&&!o&&ce(t,e,n,s)},ie=(t,e)=>{t.relX+=e,t.lExtRelX+=e,t.rExtRelX+=e},se=(t,e,r,a)=>{const i=t.children[e],n=e-r;if(n>1){const e=a/n;t.children[r+1].shift+=e,i.shift-=e,i.change-=a-e}},oe=t=>t.hasChildren?t.firstChild:t.lThr,ae=t=>t.hasChildren?t.lastChild:t.rThr,le=(t,e,r,a)=>{const i=t.firstChild,n=i.lExt,s=t.children[e];n.lThr=r;const o=a-r.relX-i.lExtRelX;n.relX+=o,n.prelim-=o,i.lExt=s.lExt,i.lExtRelX=s.lExtRelX},ce=(t,e,r,a)=>{const i=t.children[e],n=i.rExt,s=t.children[e-1];n.rThr=r;const o=a-r.relX-i.rExtRelX;n.relX+=o,n.prelim-=o,i.rExt=s.rExt,i.rExtRelX=s.rExtRelX},he=t=>{if(t.hasChildren){const e=t.firstChild,r=t.lastChild,a=(e.prelim+e.relX-e.xSize/2+r.relX+r.prelim+r.xSize/2)/2;Object.assign(t,{prelim:a,lExt:e.lExt,lExtRelX:e.lExtRelX,rExt:r.rExt,rExtRelX:r.rExtRelX})}},de=(t,e,r)=>{for(;null!==r&&t>=r.lowY;)r=r.next;return{lowY:t,index:e,next:r}},nt=".markmap{--markmap-max-width: 9999px;--markmap-a-color: #0097e6;--markmap-a-hover-color: #00a8ff;--markmap-code-bg: #f0f0f0;--markmap-code-color: #555;--markmap-highlight-bg: #ffeaa7;--markmap-table-border: 1px solid currentColor;--markmap-font: 300 16px/20px sans-serif;--markmap-circle-open-bg: #fff;--markmap-text-color: #333;--markmap-highlight-node-bg: #ff02;font:var(--markmap-font);color:var(--markmap-text-color)}.markmap-link{fill:none}.markmap-node>circle{cursor:pointer}.markmap-foreign{display:inline-block}.markmap-foreign p{margin:0}.markmap-foreign a{color:var(--markmap-a-color)}.markmap-foreign a:hover{color:var(--markmap-a-hover-color)}.markmap-foreign code{padding:.25em;font-size:calc(1em - 2px);color:var(--markmap-code-color);background-color:var(--markmap-code-bg);border-radius:2px}.markmap-foreign pre{margin:0}.markmap-foreign pre>code{display:block}.markmap-foreign del{text-decoration:line-through}.markmap-foreign em{font-style:italic}.markmap-foreign strong{font-weight:700}.markmap-foreign mark{background:var(--markmap-highlight-bg)}.markmap-foreign table,.markmap-foreign th,.markmap-foreign td{border-collapse:collapse;border:var(--markmap-table-border)}.markmap-foreign img{display:inline-block}.markmap-foreign svg{fill:currentColor}.markmap-foreign>div{width:var(--markmap-max-width);text-align:left}.markmap-foreign>div>div{display:inline-block}.markmap-highlight rect{fill:var(--markmap-highlight-node-bg)}.markmap-dark .markmap{--markmap-code-bg: #1a1b26;--markmap-code-color: #ddd;--markmap-circle-open-bg: #444;--markmap-text-color: #eee}",ve=nt,M="g.markmap-node",pe="path.markmap-link",ge="g.markmap-highlight",A=ft();function U(t,e){return t[vt(t,e)]}function T(t){t.stopPropagation()}const ue=new dt;class it{constructor(t,e){this.options={...J},this._disposeList=[],this.handleZoom=t=>{const{transform:e}=t;this.g.attr("transform",e)},this.handlePan=t=>{t.preventDefault();const e=w(this.svg.node()),r=e.translate(-t.deltaX/e.k,-t.deltaY/e.k);this.svg.call(this.zoom.transform,r)},this.handleClick=(t,e)=>{let r=this.options.toggleRecursively;(Z?t.metaKey:t.ctrlKey)&&(r=!r),this.toggleNode(e,r)},this.ensureView=this.ensureVisible,this.svg=t.datum?t:xt(t),this.styleNode=this.svg.append("style"),this.zoom=yt().filter((t=>this.options.scrollForPan&&"wheel"===t.type?t.ctrlKey&&!t.button:!(t.ctrlKey&&"wheel"!==t.type||t.button))).on("zoom",this.handleZoom),this.setOptions(e),this.state={id:this.options.id||this.svg.attr("id")||pt(),rect:{x1:0,y1:0,x2:0,y2:0}},this.g=this.svg.append("g"),this.g.append("g").attr("class","markmap-highlight"),this._observer=new ResizeObserver(gt((()=>{this.renderData()}),100)),this._disposeList.push(ue.tap((()=>{this.setData()})),(()=>this._observer.disconnect()))}getStyleContent(){const{style:t}=this.options,{id:e}=this.state,r="function"==typeof t?t(e):"";return[this.options.embedGlobalCSS&&nt,r].filter(Boolean).join("\n")}updateStyle(){this.svg.attr("class",ut(this.svg.attr("class"),"markmap",this.state.id));const t=this.getStyleContent();this.styleNode.text(t)}async toggleNode(t,e=!1){var r,a;const i=null!=(r=t.payload)&&r.fold?0:1;e?R(t,((t,e)=>{t.payload={...t.payload,fold:i},e()})):t.payload={...t.payload,fold:null!=(a=t.payload)&&a.fold?0:1},await this.renderData(t)}_initializeData(t){let e=0;const{color:r,initialExpandLevel:a}=this.options;let i=0,n=0;return R(t,((t,s,o)=>{var l,h,c,d;n+=1,t.children=null==(l=t.children)?void 0:l.map((t=>({...t}))),e+=1,t.state={...t.state,depth:n,id:e,rect:{x:0,y:0,width:0,height:0},size:[0,0]},t.state.key=[null==(h=null==o?void 0:o.state)?void 0:h.id,t.state.id].filter(Boolean).join(".")+Et(t.content),t.state.path=[null==(c=null==o?void 0:o.state)?void 0:c.path,t.state.id].filter(Boolean).join("."),r(t);const p=2===(null==(d=t.payload)?void 0:d.fold);p?i+=1:(i||a>=0&&t.state.depth>=a)&&(t.payload={...t.payload,fold:1}),s(),p&&(i-=1),n-=1})),t}_relayout(){if(!this.state.data)return;this.g.selectAll(v(M)).selectAll(v("foreignObject")).each((function(t){var e;const r=null==(e=this.firstChild)?void 0:e.firstChild,a=[r.scrollWidth,r.scrollHeight];t.state.size=a}));const{lineWidth:t,paddingX:e,spacingHorizontal:r,spacingVertical:a}=this.options,i=tt({}).children((t=>{var e;if(null==(e=t.payload)||!e.fold)return t.children})).nodeSize((t=>{const[a,i]=t.data.state.size;return[i,a+(a?2*e:0)+r]})).spacing(((e,r)=>(e.parent===r.parent?a:2*a)+t(e.data))),n=i.hierarchy(this.state.data);i(n);const s=n.descendants();s.forEach((t=>{t.data.state.rect={x:t.y,y:t.x-t.xSize/2,width:t.ySize-r,height:t.xSize}})),this.state.rect={x1:G(s,(t=>t.data.state.rect.x))||0,y1:G(s,(t=>t.data.state.rect.y))||0,x2:V(s,(t=>t.data.state.rect.x+t.data.state.rect.width))||0,y2:V(s,(t=>t.data.state.rect.y+t.data.state.rect.height))||0}}setOptions(t){this.options={...this.options,...t},this.options.zoom?this.svg.call(this.zoom):this.svg.on(".zoom",null),this.options.pan?this.svg.on("wheel",this.handlePan):this.svg.on("wheel",null)}async setData(t,e){e&&this.setOptions(e),t&&(this.state.data=this._initializeData(t)),this.state.data&&(this.updateStyle(),await this.renderData())}async setHighlight(t){this.state.highlight=t||void 0,await this.renderData()}_getHighlightRect(t){const e=this.svg.node(),r=4/w(e).k,a={...t.state.rect};return a.x-=r,a.y-=r,a.width+=2*r,a.height+=2*r,a}async renderData(t){const{paddingX:e,autoFit:r,color:a,maxWidth:i,lineWidth:n}=this.options,s=this.state.data;if(!s)return;const o={},l={},h=[];R(s,((t,e,r)=>{var a;null!=(a=t.payload)&&a.fold||e(),o[t.state.id]=t,r&&(l[t.state.id]=r.state.id),h.push(t)}));const c={},d={},p=t=>{!t||c[t.state.id]||R(t,((e,r)=>{c[e.state.id]=t.state.id,r()}))},u=t=>d[c[t.state.id]]||s.state.rect,g=t=>(o[c[t.state.id]]||s).state.rect;d[s.state.id]=s.state.rect,t&&p(t);let{highlight:m}=this.state;m&&!o[m.state.id]&&(m=void 0);let f=this.g.selectAll(v(ge)).selectAll(v("rect")).data(m?[this._getHighlightRect(m)]:[]).join("rect").attr("x",(t=>t.x)).attr("y",(t=>t.y)).attr("width",(t=>t.width)).attr("height",(t=>t.height));const x=this.g.selectAll(v(M)).each((t=>{d[t.state.id]=t.state.rect})).data(h,(t=>t.state.key)),y=x.enter().append("g").attr("data-depth",(t=>t.state.depth)).attr("data-path",(t=>t.state.path)).each((t=>{p(o[l[t.state.id]])})),k=x.exit().each((t=>{p(o[l[t.state.id]])})),b=x.merge(y).attr("class",(t=>{var e;return["markmap-node",(null==(e=t.payload)?void 0:e.fold)&&"markmap-fold"].filter(Boolean).join(" ")})),w=b.selectAll(v("line")).data((t=>[t]),(t=>t.state.key)),z=w.enter().append("line").attr("stroke",(t=>a(t))).attr("stroke-width",0),C=w.merge(z),E=b.selectAll(v("circle")).data((t=>{var e;return null!=(e=t.children)&&e.length?[t]:[]}),(t=>t.state.key)),S=E.enter().append("circle").attr("stroke-width",0).attr("r",0).on("click",((t,e)=>this.handleClick(t,e))).on("mousedown",T).merge(E).attr("stroke",(t=>a(t))).attr("fill",(t=>{var e;return null!=(e=t.payload)&&e.fold&&t.children?a(t):"var(--markmap-circle-open-bg)"})),X=this._observer,j=b.selectAll(v("foreignObject")).data((t=>[t]),(t=>t.state.key)),$=j.enter().append("foreignObject").attr("class","markmap-foreign").attr("x",e).attr("y",0).style("opacity",0).on("mousedown",T).on("dblclick",T);$.append("xhtml:div").append("xhtml:div").html((t=>t.content)).attr("xmlns","http://www.w3.org/1999/xhtml"),$.each((function(){var t;const e=null==(t=this.firstChild)?void 0:t.firstChild;X.observe(e)}));const H=k.selectAll(v("foreignObject"));H.each((function(){var t;const e=null==(t=this.firstChild)?void 0:t.firstChild;X.unobserve(e)}));const O=$.merge(j),B=h.flatMap((t=>{var e;return null!=(e=t.payload)&&e.fold?[]:t.children.map((e=>({source:t,target:e})))})),D=this.g.selectAll(v(pe)).data(B,(t=>t.target.state.key)),_=D.exit(),L=D.enter().insert("path","g").attr("class","markmap-link").attr("data-depth",(t=>t.target.state.depth)).attr("data-path",(t=>t.target.state.path)).attr("d",(t=>{const e=u(t.target),r=[e.x+e.width,e.y+e.height];return A({source:r,target:r})})).attr("stroke-width",0).merge(D);this.svg.style("--markmap-max-width",i?`${i}px`:null),await new Promise(requestAnimationFrame),this._relayout(),f=f.data(m?[this._getHighlightRect(m)]:[]).join("rect"),this.transition(f).attr("x",(t=>t.x)).attr("y",(t=>t.y)).attr("width",(t=>t.width)).attr("height",(t=>t.height)),y.attr("transform",(t=>{const e=u(t);return`translate(${e.x+e.width-t.state.rect.width},${e.y+e.height-t.state.rect.height})`})),this.transition(k).attr("transform",(t=>{const e=g(t);return`translate(${e.x+e.width-t.state.rect.width},${e.y+e.height-t.state.rect.height})`})).remove(),this.transition(b).attr("transform",(t=>`translate(${t.state.rect.x},${t.state.rect.y})`));const W=k.selectAll(v("line"));this.transition(W).attr("x1",(t=>t.state.rect.width)).attr("stroke-width",0),z.attr("x1",(t=>t.state.rect.width)).attr("x2",(t=>t.state.rect.width)),C.attr("y1",(t=>t.state.rect.height+n(t)/2)).attr("y2",(t=>t.state.rect.height+n(t)/2)),this.transition(C).attr("x1",-1).attr("x2",(t=>t.state.rect.width+2)).attr("stroke",(t=>a(t))).attr("stroke-width",n);const F=k.selectAll(v("circle"));this.transition(F).attr("r",0).attr("stroke-width",0),S.attr("cx",(t=>t.state.rect.width)).attr("cy",(t=>t.state.rect.height+n(t)/2)),this.transition(S).attr("r",6).attr("stroke-width","1.5"),this.transition(H).style("opacity",0),O.attr("width",(t=>Math.max(0,t.state.rect.width-2*e))).attr("height",(t=>t.state.rect.height)),this.transition(O).style("opacity",1),this.transition(_).attr("d",(t=>{const e=g(t.target),r=[e.x+e.width,e.y+e.height+n(t.target)/2];return A({source:r,target:r})})).attr("stroke-width",0).remove(),this.transition(L).attr("stroke",(t=>a(t.target))).attr("stroke-width",(t=>n(t.target))).attr("d",(t=>{const e=t.source,r=t.target,a=[e.state.rect.x+e.state.rect.width,e.state.rect.y+e.state.rect.height+n(e)/2],i=[r.state.rect.x,r.state.rect.y+r.state.rect.height+n(r)/2];return A({source:a,target:i})})),r&&this.fit()}transition(t){const{duration:e}=this.options;return t.transition().duration(e)}async fit(t=this.options.maxInitialScale){const e=this.svg.node(),{width:r,height:a}=e.getBoundingClientRect(),{fitRatio:i}=this.options,{x1:n,y1:s,x2:o,y2:l}=this.state.rect,h=o-n,c=l-s,d=Math.min(r/h*i,a/c*i,t),p=kt.translate((r-h*d)/2-n*d,(a-c*d)/2-s*d).scale(d);return this.transition(this.svg).call(this.zoom.transform,p).end().catch(X)}findElement(t){let e;return this.g.selectAll(v(M)).each((function(r){r===t&&(e={data:r,g:this})})),e}async ensureVisible(t,e){var r;const a=null==(r=this.findElement(t))?void 0:r.data;if(!a)return;const i=this.svg.node(),n=i.getBoundingClientRect(),s=w(i),[o,l]=[a.state.rect.x,a.state.rect.x+a.state.rect.width+2].map((t=>t*s.k+s.x)),[h,c]=[a.state.rect.y,a.state.rect.y+a.state.rect.height].map((t=>t*s.k+s.y)),d={left:0,right:0,top:0,bottom:0,...e},p=[d.left-o,n.width-d.right-l],u=[d.top-h,n.height-d.bottom-c],g=p[0]*p[1]>0?U(p,Math.abs)/s.k:0,m=u[0]*u[1]>0?U(u,Math.abs)/s.k:0;if(g||m){const t=s.translate(g,m);return this.transition(this.svg).call(this.zoom.transform,t).end().catch(X)}}async centerNode(t,e){var r;const a=null==(r=this.findElement(t))?void 0:r.data;if(!a)return;const i=this.svg.node(),n=i.getBoundingClientRect(),s=w(i),o=(a.state.rect.x+a.state.rect.width/2)*s.k+s.x,l=(a.state.rect.y+a.state.rect.height/2)*s.k+s.y,h={left:0,right:0,top:0,bottom:0,...e},c=(h.left+n.width-h.right)/2,d=(h.top+n.height-h.bottom)/2,p=(c-o)/s.k,u=(d-l)/s.k;if(p||u){const t=s.translate(p,u);return this.transition(this.svg).call(this.zoom.transform,t).end().catch(X)}}async rescale(t){const e=this.svg.node(),{width:r,height:a}=e.getBoundingClientRect(),i=r/2,n=a/2,s=w(e),o=s.translate((i-s.x)*(1-t)/s.k,(n-s.y)*(1-t)/s.k).scale(t);return this.transition(this.svg).call(this.zoom.transform,o).end().catch(X)}destroy(){this.svg.on(".zoom",null),this.svg.html(null),this._disposeList.forEach((t=>{t()}))}static create(t,e,r=null){const a=new it(t,e);return r&&a.setData(r).then((()=>{a.fit()})),a}}export{it as Markmap,v as childSelector,bt as defaultColorFn,J as defaultOptions,ke as deriveOptions,ve as globalCSS,Z as isMacintosh,q as lineWidthFactory,ze as loadCSS,we as loadJS,ue as refreshHook,Et as simpleHash};
//# sourceMappingURL=/sm/24224af53dc999cbadd0cc32e4eb127801daa1f718849b44390f94dda562d0aa.map